<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Planilha Financeira - 24 Meses</title>
    <style>
        table {
            border-collapse: collapse;
            margin: 20px;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            min-width: 120px;
        }
        
        th {
            background-color: #f2f2f2;
        }
        
        .categoria {
            text-align: left;
            background-color: #e6f3ff;
        }
        
        input {
            width: 100px;
            padding: 3px;
            text-align: right;
        }
        
        .total {
            background-color: #ffe6e6;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <table id="planilha">
        <tr>
            <th class="categoria">Categoria</th>
            <!-- Meses serão inseridos aqui via JavaScript -->
        </tr>
        
        <!-- Categorias de Gastos -->
        <tr>
            <td class="categoria">Aluguel</td>
        </tr>
        <tr>
            <td class="categoria">Alimentação</td>
        </tr>
        <tr>
            <td class="categoria">Transporte</td>
        </tr>
        <tr>
            <td class="categoria">Saúde</td>
        </tr>
        <tr>
            <td class="categoria">Lazer</td>
        </tr>
        <tr>
            <td class="categoria">Educação</td>
        </tr>
        <tr>
            <td class="categoria">Impostos</td>
        </tr>
        <tr>
            <td class="categoria">Serviços</td>
        </tr>
        <tr>
            <td class="categoria">Outros</td>
        </tr>
        
        <!-- Linha de Total -->
        <tr>
            <td class="categoria total">Total por Mês</td>
        </tr>
    </table>

    <script>
        // Função para criar os meses
        function criarMeses() {
            const tabela = document.getElementById('planilha');
            const data = new Date();
            
            for(let i = 0; i < 24; i++) {
                const mesAno = data.toLocaleDateString('pt-BR', {
                    month: '2-digit',
                    year: 'numeric'
                }).replace('/', '/');
                
                // Adicionar cabeçalho do mês
                const th = document.createElement('th');
                th.textContent = mesAno;
                tabela.rows[0].appendChild(th);
                
                // Adicionar campos de entrada para cada categoria
                for(let j = 1; j < tabela.rows.length - 1; j++) {
                    const td = document.createElement('td');
                    td.innerHTML = `<input type="number" step="0.01" class="valor">`;
                    tabela.rows[j].appendChild(td);
                }
                
                // Adicionar célula de total
                const tdTotal = document.createElement('td');
                tdTotal.className = 'total';
                tdTotal.id = `total-${i}`;
                tabela.rows[tabela.rows.length - 1].appendChild(tdTotal);
                
                data.setMonth(data.getMonth() + 1);
            }
        }

        // Função para calcular totais
        function calcularTotais() {
            const inputs = document.querySelectorAll('.valor');
            
            inputs.forEach(input => {
                input.addEventListener('input', () => {
                    const indexMes = input.parentElement.cellIndex - 1;
                    const totalMes = document.getElementById(`total-${indexMes}`);
                    
                    let total = 0;
                    document.querySelectorAll(`tr td:nth-child(${indexMes + 2}) input`).forEach(input => {
                        total += parseFloat(input.value) || 0;
                    });
                    
                    totalMes.textContent = total.toFixed(2);
                });
            });
        }

        // Inicializar
        window.onload = function() {
            criarMeses();
            calcularTotais();
        };
    </script>
</body>
</html>
